SELECT * FROM "USERNAME"."TBL_QUESTIONS" WHERE Answers>=1 order by Created desc OFFSET 1 ROWS FETCH NEXT 1 ROWS ONLY;
SELECT COUNT (*) FROM "USERNAME"."TBL_QUESTIONS" WHERE Answers=0;
SELECT * FROM "USERNAME"."TBL_QUESTION_VOTES" WHERE Qid=2 AND OwnerNickname='wizzi';
UPDATE "USERNAME"."TBL_QUESTIONS" SET QVotes = 5, QRating = 3  WHERE QId=2;
SELECT AVG(CAST (AVotes AS DOUBLE PRECISION)) FROM "USERNAME"."TBL_ANSWERS" WHERE Qid=111;
UPDATE "USERNAME"."TBL_QUESTIONS" SET QRating = QVotes * 0.5 + 1 * 0.8 WHERE QId=2;
SELECT * FROM "USERNAME"."TBL_ANSWERS"  ORDER BY AVotes DESC, Created DESC;
SELECT AVG(CAST (Qrating AS DOUBLE PRECISION)) FROM "USERNAME"."TBL_QUESTIONS" WHERE OwnerNickname='nana';
UPDATE "USERNAME"."TBL_USERS" SET UserRating =0 WHERE Nickname='nana';
UPDATE "USERNAME"."TBL_USERS" SET UserRating=(0.2*(SELECT AVG(CAST (Qrating AS DOUBLE PRECISION)) FROM "USERNAME"."TBL_QUESTIONS" WHERE OwnerNickname='nana')+
0.8*(SELECT AVG(CAST (AVotes AS DOUBLE PRECISION)) FROM "USERNAME"."TBL_ANSWERS" WHERE OwnerNickname='nana')) WHERE Nickname='nana';

SELECT "USERNAME"."TBL_TOPICS".QTopics,sum("USERNAME"."TBL_QUESTIONS".QRating) as sumup
FROM "USERNAME"."TBL_TOPICS"
INNER JOIN "USERNAME"."TBL_QUESTIONS"
ON "USERNAME"."TBL_TOPICS".QId="USERNAME"."TBL_QUESTIONS".QId
GROUP BY "USERNAME"."TBL_TOPICS".QTopics
ORDER BY sumup desc
OFFSET 1 ROWS FETCH NEXT 2 ROWS ONLY;

SELECT COUNT (DISTINCT QTopics) FROM "USERNAME"."TBL_TOPICS";

SELECT "USERNAME"."TBL_QUESTIONS".*
FROM "USERNAME"."TBL_TOPICS"
INNER JOIN "USERNAME"."TBL_QUESTIONS"
ON "USERNAME"."TBL_TOPICS".QId="USERNAME"."TBL_QUESTIONS".QId
where "USERNAME"."TBL_TOPICS".QTopics='banana'
OFFSET 0 ROWS FETCH NEXT 20 ROWS ONLY;

SELECT "USERNAME"."TBL_TOPICS".qtopics, sum("USERNAME"."TBL_QUESTIONS".qvotes) as sigma FROM "USERNAME"."TBL_ANSWERS" INNER JOIN "USERNAME"."TBL_QUESTIONS" ON "USERNAME"."TBL_ANSWERS".QId="USERNAME"."TBL_QUESTIONS".QId inner join "USERNAME"."TBL_TOPICS" ON "USERNAME"."TBL_TOPICS".QId="USERNAME"."TBL_QUESTIONS".QId where "USERNAME"."TBL_ANSWERS".OwnerNickname = 'nana' group by "USERNAME"."TBL_TOPICS".qtopics order by sigma desc FETCH NEXT 5 ROWS ONLY;

SELECT "USERNAME"."TBL_TOPICS".qtopics, sum("USERNAME"."TBL_QUESTIONS".qvotes) as sigma 
FROM "USERNAME"."TBL_ANSWERS"
INNER JOIN "USERNAME"."TBL_QUESTIONS"
ON "USERNAME"."TBL_ANSWERS".QId="USERNAME"."TBL_QUESTIONS".QId
inner join "USERNAME"."TBL_TOPICS"
ON "USERNAME"."TBL_TOPICS".QId="USERNAME"."TBL_QUESTIONS".QId
where "USERNAME"."TBL_ANSWERS".OwnerNickname = 'wizzi'
group by "USERNAME"."TBL_TOPICS".qtopics
order by sigma desc
FETCH NEXT 5 ROWS ONLY;

